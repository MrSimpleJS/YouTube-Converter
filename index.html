<!doctype html>
<html lang="de" data-theme="light">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>YouTube Thumbnail Converter</title>
  <meta name="color-scheme" content="light dark" />
  <!-- <link rel="manifest" href="./manifest.webmanifest" /> -->
  <script>
    // Set initial theme ASAP to avoid FOUC
    (function(){
      try {
        const saved = localStorage.getItem('theme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = saved || (prefersDark ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', theme);
      } catch (_) {}
    })();
  </script>
  <link rel="stylesheet" href="./style.css"/>
</head>
<body>
  <div class="container">
    <header>
      <div>
  <h1 id="title">YouTube Thumbnail Konverter</h1>
        <p id="subtitle" class="muted">Lade ein SVG und exportiere es als PNG in YouTube‚ÄëGr√∂√üe.</p>
      </div>
      <div class="toolbar">
        <!-- Hidden native select as fallback/assistive tech -->
        <select id="langSelect" class="visually-hidden">
          <option value="de">Deutsch</option>
          <option value="en">English</option>
        </select>
        <details id="langDropdown" class="lang-dropdown">
          <summary><span></span><span id="langCurrent">Deutsch</span><span class="caret">‚ñæ</span></summary>
          <ul class="lang-menu">
            <li><button id="langDeBtn" type="button">Deutsch</button></li>
            <li><button id="langEnBtn" type="button">English</button></li>
          </ul>
        </details>
        <!-- <button id="signInBtn" class="btn ghost">Anmelden</button> -->
        <button id="helpBtn" class="btn ghost" aria-label="Hilfe">‚ùì Hilfe</button>
        <span id="globalStats" class="pill stats-pill" aria-live="polite" title="Global stats">Images: 0 ‚Ä¢ Downloads: 0</span>
        <!-- User Switcher temporarily removed -->
        <button id="themeToggle" class="btn ghost" aria-label="Darstellung umschalten">üåô&nbsp;<span id="themeLabel">Dunkel</span></button>
      </div>
    </header>

    <div class="row">
      <div class="card" style="min-width:280px">
        <div class="card-header">
          <h3 id="svgCardTitle" style="margin:0">SVG</h3>
          <div class="kebab-wrap">
            <button class="kebab-toggle" type="button" aria-label="Aktionen" aria-expanded="false" data-menu="svgMenu">‚ãØ</button>
            <ul id="svgMenu" class="kebab-menu" role="menu" aria-label="SVG Aktionen">
              <li><button id="svgMenuDownload" class="menu-item" type="button" data-action="download">Download PNG</button></li>
              <li><button id="svgMenuDownload2x" class="menu-item" type="button" data-action="download2x">Download PNG @2x</button></li>
              <li><button id="svgMenuDownloadAll" class="menu-item" type="button" data-action="downloadAll">Alle exportieren (PNG)</button></li>
              <li><button id="svgMenuDownloadAll2x" class="menu-item" type="button" data-action="downloadAll2x">Alle exportieren @2x</button></li>
              <li><button id="svgMenuClear" class="menu-item danger" type="button" data-action="clearList">Liste leeren</button></li>
            </ul>
          </div>
        </div>
        <div class="dropzone" id="dropzone" aria-label="SVG hier ablegen oder √ºber Datei ausw√§hlen">
          <input class="visually-hidden" type="file" id="file" accept=".svg,image/svg+xml" multiple/>
          <div class="picker">
            <button id="openPicker" class="pill" type="button" aria-controls="file">üìÅ Dateien ausw√§hlen</button>
            <span id="selectedInfo" class="meta">Keine ausgew√§hlt</span>
          </div>
          <p class="muted" style="margin:8px 6px 0">Oder per Drag & Drop hier ablegen.</p>
        </div>
        <div class="controls actions">
          <button class="btn" id="download" type="button">Download PNG</button>
          <button class="btn secondary" id="download2x" type="button">Download PNG @2x (2560√ó1440)</button>
        </div>
        <div class="controls actions">
          <button class="btn" id="downloadAll" type="button">Alle exportieren (PNG)</button>
          <button class="btn secondary" id="downloadAll2x" type="button">Alle exportieren @2x</button>
        </div>
        <div class="controls actions">
          <button class="btn danger" id="clearList" type="button">Liste leeren</button>
        </div>
        <p id="status" class="muted status" aria-live="polite">Kein SVG geladen.</p>
        <ul id="fileList" class="file-list" aria-label="Geladene Dateien"></ul>
      </div>

      <div class="card grow">
  <h3 id="previewTitle" style="margin-top:0">Vorschau</h3>
        <div class="preview-wrap">
          <canvas id="canvas" width="1280" height="720"></canvas>
          <div id="dimBadge" class="dim-badge" aria-live="polite">1280√ó720</div>
        </div>
      </div>
    </div>

    <!-- Raster Converter -->
    <div class="row" style="margin-top:20px">
      <div class="card" style="min-width:280px;flex:1 1 340px">
        <div class="card-header">
          <h3 id="rCardTitle" style="margin:0">JPG/PNG Konverter</h3>
          <div class="kebab-wrap">
            <button class="kebab-toggle" type="button" aria-label="Aktionen" aria-expanded="false" data-menu="rMenu">‚ãØ</button>
            <ul id="rMenu" class="kebab-menu" role="menu" aria-label="Raster Aktionen">
              <li><button id="rMenuSinglePNG" class="menu-item" type="button" data-action="rDownloadPNG">Zu PNG (einzeln)</button></li>
              <li><button id="rMenuSingleJPG" class="menu-item" type="button" data-action="rDownloadJPG">Zu JPG (einzeln)</button></li>
              <li><button id="rMenuAllPNG" class="menu-item" type="button" data-action="rDownloadAllPNG">Alle ‚Üí PNG</button></li>
              <li><button id="rMenuAllJPG" class="menu-item" type="button" data-action="rDownloadAllJPG">Alle ‚Üí JPG</button></li>
              <li><button id="rMenuClear" class="menu-item danger" type="button" data-action="rClearList">Liste leeren</button></li>
            </ul>
          </div>
        </div>
        <div class="dropzone" id="rDropzone" aria-label="Bilder hier ablegen oder √ºber Datei ausw√§hlen">
          <input class="visually-hidden" type="file" id="rFile" accept=".jpg,.jpeg,.png,image/jpeg,image/png" multiple/>
          <div class="picker">
            <button id="openRPicker" class="pill" type="button" aria-controls="rFile">üìÅ Bilder ausw√§hlen</button>
            <span id="rSelectedInfo" class="meta">Keine ausgew√§hlt</span>
          </div>
          <p class="muted" style="margin:8px 6px 0">Oder per Drag & Drop hier ablegen.</p>
        </div>

        <div class="controls actions">
          <button class="btn" id="rDownloadPNG" type="button">Zu PNG (einzeln)</button>
          <button class="btn secondary" id="rDownloadJPG" type="button">Zu JPG (einzeln)</button>
        </div>
        <div class="controls actions">
          <button class="btn" id="rDownloadAllPNG" type="button">Alle ‚Üí PNG</button>
          <button class="btn secondary" id="rDownloadAllJPG" type="button">Alle ‚Üí JPG</button>
        </div>

        <div class="controls">
          <input id="urlInput" class="input" type="url" placeholder="https://... (PNG, JPG)"/>
          <button class="btn" id="loadFromUrl" type="button">Bild von URL laden</button>
        </div>

        <div class="controls actions">
          <button class="btn danger" id="rClearList" type="button">Liste leeren</button>
        </div>

        <p id="rStatus" class="muted status" aria-live="polite">Keine Bilder geladen.</p>
        <ul id="rFileList" class="file-list" aria-label="Geladene Bilder"></ul>
      </div>
      <div class="card" style="min-width:280px;flex:1 1 340px">
        <div class="card-header">
          <h3 id="ytCardTitle" style="margin:0">YouTube Thumbnails</h3>
          <div class="kebab-wrap">
            <button class="kebab-toggle" type="button" aria-label="Aktionen" aria-expanded="false" data-menu="ytMenu">‚ãØ</button>
            <ul id="ytMenu" class="kebab-menu" role="menu" aria-label="YouTube Aktionen">
              <li><button id="ytMenuLoadBtn" class="menu-item" type="button" data-action="ytFetch">Laden</button></li>
              <li><button id="ytMenuAllBtn" class="menu-item" type="button" data-action="ytDownloadAll">Alle herunterladen</button></li>
            </ul>
          </div>
        </div>
        <div class="controls">
          <input id="ytUrl" class="input" type="url" placeholder="https://www.youtube.com/watch?v=... oder youtu.be/..."/>
          <button class="btn" id="ytFetch" type="button">Laden</button>
        </div>
        <p id="ytStatus" class="muted status" aria-live="polite">F√ºge einen YouTube-Link ein, um Vorschaubilder zu laden.</p>
        <ul id="ytList" class="file-list" aria-label="YouTube Thumbnails"></ul>
      </div>
    </div>

    <!-- Settings -->
    <div class="row" style="margin-top:20px">
      <div class="card" style="min-width:280px;flex:1 1 700px">
        <h3 id="settingsTitle" style="margin-top:0">Einstellungen</h3>
        <div class="settings-grid">
          <label class="field">
            <span id="checkerLabel" class="muted">Schachbrett (Transparenz)</span>
            <label class="switch"><input type="checkbox" id="optChecker" checked> <span id="checkerToggleLabel">anzeigen</span></label>
          </label>
          <label class="field">
            <span id="presetLabel" class="muted">Preset (Gr√∂√üe)</span>
            <select id="optPreset" class="input">
              <option id="optOriginal" value="original">Original</option>
              <option id="opt1280" value="1280x720">1280√ó720</option>
              <option id="opt1920" value="1920x1080">1920√ó1080</option>
              <option id="opt1080s" value="1080x1080">1080√ó1080</option>
              <option id="opt1080p" value="1080x1920">1080√ó1920</option>
            </select>
          </label>
          <label class="field">
            <span id="resizeLabel" class="muted">Resize-Modus</span>
            <select id="optMode" class="input">
              <option value="contain">Contain</option>
              <option value="cover">Cover</option>
              <option value="stretch">Stretch</option>
            </select>
          </label>
          <label class="field">
            <span id="jpgBgLabel" class="muted">JPG Hintergrund</span>
            <input id="optJpgBg" type="color" value="#ffffff"/>
          </label>
          <label class="field">
            <span id="previewBgLabel" class="muted">Vorschau Hintergrund anwenden</span>
            <label class="switch"><input type="checkbox" id="optPreviewBg" checked> <span id="previewBgToggle">verwenden</span></label>
          </label>
          <label class="field">
            <span id="jpgQLabel" class="muted">JPG Qualit√§t</span>
            <input id="optJpgQ" type="range" min="60" max="100" step="1" value="92"/>
          </label>
          <label class="field">
            <span id="workerLabel" class="muted">Batch mit Web Worker</span>
            <label class="switch"><input type="checkbox" id="optWorker"> <span id="workerToggleLabel">aktivieren</span></label>
          </label>
        </div>
  <p id="saveHint" class="muted" style="margin-top:8px">√Ñnderungen werden gespeichert.</p>
        <div class="settings-footer">
          <button id="tourResetBtn" type="button" class="btn ghost tiny left">Tour zur√ºcksetzen</button>
          <span id="privacyState" class="muted state-chip" title="Datenschutz">Verlaufsspeicherung: unbekannt</span>
          <button id="privacyChange" type="button" class="btn ghost tiny">Einstellung √§ndern</button>
        </div>
      </div>
    </div>

    <!-- Export History -->
    <div class="row" style="margin-top:20px">
      <div class="card" style="min-width:280px;flex:1 1 700px">
        <h3 id="exportsTitle" style="margin-top:0">Exporte</h3>
  <p id="exportsHint" class="muted">Hier siehst du deine zuletzt exportierten Bilder (lokal gespeichert).</p>
        <div class="controls" style="margin-top:0;align-items:center">
          <label class="field" style="min-width:160px">
            <span class="muted">Filter</span>
            <select id="historyFilter" class="input">
              <option value="">Alle</option>
              <option value="svg->png">SVG ‚Üí PNG</option>
              <option value="img->png">IMG ‚Üí PNG</option>
              <option value="img->jpg">IMG ‚Üí JPG</option>
            </select>
          </label>
          <div style="display:flex;gap:8px;align-items:center">
            <button id="prevPage" type="button" class="btn ghost">‚Üê</button>
            <span id="pageInfo" class="muted">1 / 1</span>
            <button id="nextPage" type="button" class="btn ghost">‚Üí</button>
          </div>
          <span id="statsSummary" class="muted" style="margin-left:auto">‚Äì</span>
        </div>
        <ul id="exportList" class="file-list" aria-label="Exportverlaufs-Liste"></ul>
      </div>
    </div>

    <!-- Admin Control Panel (client-only) -->
    <div class="row" style="margin-top:20px">
      <div id="adminPanel" class="card" style="display:none;min-width:280px;flex:1 1 700px">
        <h3 id="adminTitle" style="margin-top:0">Admin Bereich</h3>
        <div class="controls" style="margin-top:0;align-items:center;flex-wrap:wrap">
          <label class="field" style="min-width:160px">
            <span class="muted" id="auditUserLabel">Benutzer</span>
            <select id="auditUserFilter" class="input">
              <option value="">Alle Benutzer</option>
            </select>
          </label>
          <label class="field" style="min-width:160px">
            <span class="muted" id="auditActionLabel">Aktion</span>
            <select id="auditActionFilter" class="input">
              <option value="">Alle Aktionen</option>
            </select>
          </label>
          <label class="field" style="min-width:160px">
            <span class="muted" id="auditFromLabel">Von</span>
            <input id="auditFrom" type="date" class="input" />
          </label>
          <label class="field" style="min-width:160px">
            <span class="muted" id="auditToLabel">Bis</span>
            <input id="auditTo" type="date" class="input" />
          </label>
          <div style="display:flex;gap:8px;align-items:center;margin-left:auto">
            <button id="auditExportBtn" type="button" class="btn secondary">Export JSON</button>
            <button id="auditClearBtn" type="button" class="btn danger">Log leeren</button>
          </div>
        </div>
        <div class="controls" style="margin-top:0;align-items:center">
          <div style="display:flex;gap:8px;align-items:center">
            <button id="auditPrev" type="button" class="btn ghost">‚Üê</button>
            <span id="auditPageInfo" class="muted">1 / 1</span>
            <button id="auditNext" type="button" class="btn ghost">‚Üí</button>
          </div>
          <span id="auditStats" class="muted" style="margin-left:auto">‚Äì</span>
        </div>
        <!-- Audit mini charts -->
        <div id="auditCharts" class="audit-charts" style="display:none">
          <div class="mini-card">
            <h4 id="chartTopEventsTitle" style="margin:0 0 6px">Top-Aktionen</h4>
            <div id="chartTopEvents" class="bars"></div>
          </div>
          <div class="mini-card">
            <h4 id="chartActivityTitle" style="margin:0 0 6px">Aktivit√§t (7 Tage)</h4>
            <div id="chartActivity7" class="columns" aria-label="Aktivit√§t letzte 7 Tage"></div>
          </div>
          <div class="mini-card">
            <h4 id="chartUsersTitle" style="margin:0 0 6px">Benutzer-Verteilung</h4>
            <div id="chartUsersDist" class="bars"></div>
          </div>
        </div>
        <ul id="auditList" class="file-list" aria-label="Admin Audit Log"></ul>
      </div>
    </div>
  </div>
  <footer class="site-footer" aria-label="Site credits">
    <span class="credit-text">Made with <span aria-hidden="true" class="heart">‚ù§</span><span class="sr-only">love</span> by <a href="https://github.com/MrSimpleJS" target="_blank" rel="noopener noreferrer">Mr_Simple</a> ‚Ä¢ <span id="year"></span></span>
  </footer>
  <!-- Auth Overlay (client-only) -->
  <div id="authOverlay" class="auth-overlay" role="dialog" aria-modal="true" hidden>
    <div class="auth-modal card" role="document">
      <h3 id="authTitle" style="margin-top:0">Anmelden</h3>
      <div class="field">
        <span id="authNameLabel" class="muted">Name</span>
        <input id="authName" class="input" type="text" autocomplete="username"/>
      </div>
      <div class="field">
        <span id="authPasswordLabel" class="muted">Passwort</span>
        <input id="authPassword" class="input" type="password" autocomplete="current-password"/>
      </div>
      <div class="controls" style="margin-top:0;align-items:center;justify-content:space-between">
        <label class="switch"><input type="checkbox" id="authRemember"> <span id="authRememberLabel">Angemeldet bleiben</span></label>
        <button id="authForgot" type="button" class="btn ghost">Passwort vergessen?</button>
      </div>
      <div id="authConfirmWrap" class="field" style="display:none">
        <span id="authConfirmLabel" class="muted">Passwort best√§tigen</span>
        <input id="authConfirm" class="input" type="password" autocomplete="new-password"/>
      </div>
      <div id="authSecWrap" class="field" style="display:none">
        <span id="authSecQLabel" class="muted">Sicherheitsfrage</span>
        <input id="authSecQ" class="input" type="text" placeholder="z. B. Lieblingsfarbe"/>
      </div>
      <div id="authSecAnsWrap" class="field" style="display:none">
        <span id="authSecALabel" class="muted">Antwort</span>
        <input id="authSecA" class="input" type="text"/>
      </div>
      <p id="authStatus" class="muted status" aria-live="polite"></p>
      <div class="controls">
        <button id="authSubmit" type="button" class="btn">Anmelden</button>
        <button id="authToggleMode" type="button" class="btn ghost">Neu registrieren</button>
      </div>
    </div>
  </div>
  
  <!-- Privacy Consent Overlay -->
  <div id="consentOverlay" class="auth-overlay" role="dialog" aria-modal="true" hidden>
    <div class="auth-modal card consent-modal" role="document">
      <div class="modal-header">
        <div class="consent-icon" aria-hidden="true">üîí</div>
        <h3 id="privacyTitle" class="modal-title">Datenschutz</h3>
      </div>
      <p id="privacyBody" class="modal-body muted">D√ºrfen wir Ihre Exporte lokal (auf diesem Ger√§t) speichern, um die Verlaufsliste anzuzeigen?</p>
      <div class="modal-actions">
        <button id="privacyNo" type="button" class="btn ghost">Nein, nicht speichern</button>
        <button id="privacyYes" type="button" class="btn">Ja, lokal speichern</button>
      </div>
    </div>
  </div>
  
  <!-- Guided Tour (client-only) -->
  <div id="tourHighlight" class="tour-highlight" hidden></div>
  <div id="tourOverlay" class="tour-overlay" role="dialog" aria-modal="true" hidden>
    <div id="tourTooltip" class="tour-tooltip card" role="document">
      <h4 id="tourStepTitle" style="margin:0 0 6px">Willkommen</h4>
  <p id="tourStepBody" class="muted" style="margin:0 0 10px">Kurze Tour durch die wichtigsten Funktionen.</p>
  <div id="tourStepCount" class="muted" style="font-size:.85rem;margin:0 0 8px">1 / 6</div>
      <div class="controls" style="margin-top:6px;justify-content:space-between">
        <button id="tourSkip" class="btn ghost" type="button">√úberspringen</button>
        <div style="display:flex;gap:6px">
          <button id="tourBack" class="btn ghost" type="button">Zur√ºck</button>
          <button id="tourNext" class="btn" type="button">Weiter</button>
        </div>
      </div>
    </div>
  </div>
  <script src="./app.js"></script>
</body>
</html>