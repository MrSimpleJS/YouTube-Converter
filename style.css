:root{
  --bg:#f6f8fa;--fg:#0f172a;--muted:#475569;--card-bg:#fff;--border:#e2e8f0;--shadow:0 6px 16px rgba(0,0,0,.06);
  --primary:#2563eb;--primary-fg:#fff;--success:#10b981;--danger-start:#ef4444;--danger-end:#f87171;--danger-fg:#fff;
  --canvas-check-a:#e5e7eb;--canvas-check-b:#f8fafc;--scrollbar-size:10px;--scrollbar-track:#e5e7eb;--scrollbar-thumb:#c5ccd6;--scrollbar-thumb-hover:#b7bec8;
  color-scheme:light;
}
html[data-theme="dark"]{
  --bg:#0b1220;--fg:#e5e7eb;--muted:#94a3b8;--card-bg:#0f172a;--border:#1f2937;--shadow:0 8px 24px rgba(0,0,0,.35);
  --primary:#3b82f6;--primary-fg:#0b1220;--success:#34d399;--danger-start:#f43f5e;--danger-end:#ef4444;--danger-fg:#fff;
  --canvas-check-a:#111827;--canvas-check-b:#0b1220;--scrollbar-track:#1f2937;--scrollbar-thumb:#4b5563;--scrollbar-thumb-hover:#64748b;
  color-scheme:dark;
}
@media (prefers-color-scheme: dark){:root:not([data-theme]){color-scheme:dark}}
html{scroll-behavior:smooth}
@media (prefers-reduced-motion: reduce){html{scroll-behavior:auto}}
*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0;padding:24px;background:var(--bg);color:var(--fg);scrollbar-gutter:stable both-edges}
*{scrollbar-width:thin;scrollbar-color:var(--scrollbar-thumb) transparent}
*::-webkit-scrollbar{width:var(--scrollbar-size);height:var(--scrollbar-size)}
*::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb);border-radius:999px;border:3px solid transparent;background-clip:content-box}
*::-webkit-scrollbar-thumb:hover{background-color:var(--scrollbar-thumb-hover)}
*::-webkit-scrollbar-track{background:transparent}
.file-list::-webkit-scrollbar-track,.lang-menu::-webkit-scrollbar-track{background:var(--scrollbar-track);border-radius:999px}
.container{max-width:1100px;margin:0 auto}
header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;gap:12px;flex-wrap:wrap}
h1{font-size:clamp(20px,3vw,28px);margin:0}
.muted{color:var(--muted)}
.toolbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.row{display:flex;gap:24px;flex-wrap:wrap}
.card{background:var(--card-bg);border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:var(--shadow)}
.card.grow{flex:1 1 600px}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
.btn{background:var(--primary);color:var(--primary-fg);border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
.btn.secondary{background:var(--success)}
.btn.ghost{background:transparent;color:var(--fg);border:1px solid var(--border)}
.btn.danger{background:linear-gradient(135deg,var(--danger-start),var(--danger-end));color:var(--danger-fg);border:none;box-shadow:0 8px 20px rgba(239,68,68,.25);transition:transform .12s ease,filter .12s ease,box-shadow .12s ease}
html[data-theme="dark"] .btn.danger{box-shadow:0 10px 24px rgba(239,68,68,.35)}
.btn.danger:hover{transform:translateY(-1px);filter:brightness(1.05)}
.btn:disabled{opacity:.55;cursor:not-allowed;filter:saturate(.75)}
.status{margin-top:8px}
label[for="file"]{font-weight:600}
.file-list{list-style:none;margin:12px 0 0;padding:0;max-height:260px;overflow:auto;border:1px solid var(--border);border-radius:8px}
.file-item{padding:8px 10px;cursor:pointer;border-bottom:1px solid var(--border)}
.file-item:last-child{border-bottom:none}
.file-item:hover{background:rgba(0,0,0,.04)}
html[data-theme="dark"] .file-item:hover{background:rgba(255,255,255,.04)}
.file-item.active{background:var(--primary);color:var(--primary-fg)}
.thumb{width:56px;height:42px;object-fit:cover;border:1px solid var(--border);border-radius:6px;margin-right:8px;background:var(--card-bg)}
.export-row{display:flex;align-items:center;gap:10px}
.preview-wrap{width:100%;max-width:720px;position:relative}
canvas{display:block;width:100%;height:auto;border-radius:8px;border:1px solid var(--border);background:linear-gradient(45deg,var(--canvas-check-a) 25%,transparent 25%) 0 0/20px 20px,linear-gradient(-45deg,var(--canvas-check-a) 25%,transparent 25%) 0 0/20px 20px,linear-gradient(45deg,transparent 75%,var(--canvas-check-a) 75%) 0 0/20px 20px,linear-gradient(-45deg,transparent 75%,var(--canvas-check-a) 75%) 0 0/20px 20px,var(--canvas-check-b)}
.dim-badge{position:absolute;right:10px;top:10px;background:rgba(0,0,0,.6);color:#fff;padding:4px 8px;border-radius:999px;font-size:.8rem;border:1px solid var(--border);pointer-events:none}
html[data-theme="light"] .dim-badge{background:rgba(255,255,255,.7);color:#111}
.dropzone{padding:14px;border:1px dashed var(--border);border-radius:12px;background:transparent;transition:border-color .2s,background .2s}
.dropzone.dragover{border-color:var(--primary);background:rgba(37,99,235,.06)}
html[data-theme="dark"] .dropzone.dragover{background:rgba(59,130,246,.08)}
.visually-hidden{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.picker{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.picker .hint{font-size:.9rem}
.pill{display:inline-flex;align-items:center;gap:8px;background:transparent;border:1px solid var(--border);color:var(--fg);border-radius:999px;padding:6px 10px;font-weight:600;cursor:pointer}
.pill:hover{border-color:var(--primary)}
/* Stats pill (non-clickable) */
.stats-pill{cursor:default; user-select:none; opacity:.95}
html[data-theme="dark"] .stats-pill{background:rgba(255,255,255,.02)}
.meta{color:var(--muted)}
.input{width:100%;max-width:480px;background:transparent;color:var(--fg);border:1px solid var(--border);border-radius:10px;padding:10px 12px}
.input::placeholder{color:var(--muted)}
.lang-dropdown{position:relative}
.lang-dropdown > summary{list-style:none;cursor:pointer;border:1px solid var(--border);border-radius:999px;padding:6px 12px;display:inline-flex;align-items:center;gap:6px;background:transparent;color:var(--fg);font-weight:600}
.lang-dropdown > summary::-webkit-details-marker{display:none}
.lang-dropdown > summary:hover{border-color:var(--primary)}
.lang-dropdown .caret{opacity:.8}
.lang-menu{position:absolute;right:0;margin-top:8px;background:var(--card-bg);color:var(--fg);border:1px solid var(--border);border-radius:10px;box-shadow:var(--shadow);padding:6px 6px;list-style:none;display:flex;flex-direction:column;gap:4px;min-width:140px;z-index:10}
.lang-menu button{width:100%;text-align:left;background:transparent;color:var(--fg);border:none;border-radius:8px;padding:8px 10px;cursor:pointer;font-weight:600}
.lang-menu button:hover{background:rgba(0,0,0,.06)}
html[data-theme="dark"] .lang-menu button:hover{background:rgba(255,255,255,.06)}
.lang-dropdown[aria-label="Benutzer w√§hlen"] .lang-menu{min-width:180px}
.settings-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
.field{display:flex;flex-direction:column;gap:6px}
.switch{display:inline-flex;align-items:center;gap:8px;cursor:pointer}
.switch input{accent-color:var(--primary)}
body.no-checker canvas{background:transparent!important}
@media (max-width:640px){body{padding:16px}h1{font-size:20px}.row{flex-direction:column}.card{padding:12px}.controls{flex-direction:column}.controls .btn{width:100%}.picker{flex-direction:column;align-items:stretch}.pill{width:100%;justify-content:center}.input{max-width:100%}.file-list{max-height:200px}.file-item{padding:12px}.thumb{width:64px;height:48px}.preview-wrap{max-width:100%}.lang-dropdown .lang-menu{min-width:160px}header{flex-direction:column;align-items:flex-start}.toolbar{width:100%;justify-content:space-between}}
.card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.kebab-wrap{position:relative}
.kebab-toggle{background:transparent;border:1px solid var(--border);border-radius:8px;padding:6px 10px;cursor:pointer;color:var(--fg)}
.kebab-toggle:hover{border-color:var(--primary)}
.kebab-menu{position:absolute;right:0;top:calc(100% + 6px);background:var(--card-bg);border:1px solid var(--border);border-radius:10px;box-shadow:var(--shadow);padding:6px;list-style:none;display:none;min-width:200px;z-index:20}
.kebab-menu.open{display:block}
.kebab-menu .menu-item{width:100%;text-align:left;background:transparent;border:none;border-radius:8px;padding:8px 10px;color:var(--fg);cursor:pointer;font-weight:600}
.kebab-menu .menu-item:hover{background:rgba(0,0,0,.06)}
html[data-theme="dark"] .kebab-menu .menu-item:hover{background:rgba(255,255,255,.06)}
.kebab-menu .menu-item.danger{color:#b91c1c}
@media (max-width:640px){.controls.actions{display:none}}

/* Footer credit */
.site-footer{
  max-width:1100px;margin:24px auto 0; padding:12px 0; color:var(--muted);
  border-top:1px solid var(--border); text-align:center; font-weight:600;
}

/* Auth overlay */
.auth-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;padding:16px;z-index:100}
.auth-overlay[hidden]{display:none}
.auth-modal{max-width:420px;width:100%}
.auth-modal .field{position:relative}
/* Consent modal polish */
.consent-modal{padding:18px 18px 14px}
.modal-header{display:flex;align-items:center;gap:10px;margin:0 0 8px}
.modal-title{margin:0}
.consent-icon{width:28px;height:28px;display:inline-flex;align-items:center;justify-content:center;border-radius:8px;background:linear-gradient(135deg,var(--primary),#60a5fa);color:#fff;font-size:16px;box-shadow:0 6px 14px rgba(59,130,246,.35)}
.modal-body{margin:4px 0 14px}
.modal-actions{display:flex;gap:8px;justify-content:flex-end}
/* Subtle backdrop blur for capable browsers */
@supports (backdrop-filter: blur(6px)){
  .auth-overlay{background:rgba(0,0,0,.35);backdrop-filter:blur(6px)}
}
/* Settings footer (privacy state) pinned to bottom-right area */
.settings-footer{display:flex;gap:12px;align-items:center;justify-content:flex-end;margin-top:14px;padding-top:10px;border-top:1px dashed var(--border)}
.settings-footer .left{margin-right:auto}
.settings-footer .state-chip{padding:6px 10px;border:1px solid var(--border);border-radius:999px;opacity:.9;background:transparent}
.settings-footer .state-chip:hover{border-color:var(--primary)}
.btn.tiny{padding:6px 10px;border-radius:8px;font-weight:700}
@media (max-width:640px){.settings-footer{justify-content:space-between}}
/* Pretty password toggle */
#authPassToggle{
  position:absolute;right:8px;top:50%;transform:translateY(-50%);
  padding:6px 10px;border:1px solid var(--border);border-radius:8px;
  background:var(--card-bg);color:var(--fg);font-weight:700;font-size:12px;
  box-shadow:var(--shadow);cursor:pointer;user-select:none;
}
#authPassToggle:hover{border-color:var(--primary)}
#authPassToggle:active{transform:translateY(-50%) scale(.98)}
/* Keep text clear of toggle */
#authPassword{padding-right:90px}
#capsHint{min-height:16px}

/* Footer refinements */
.site-footer .credit-text{display:inline-flex;align-items:center;gap:8px;flex-wrap:wrap}
.site-footer a{color:inherit;text-decoration:none;border-bottom:1px dashed var(--border)}
.site-footer a:hover{color:var(--fg);border-bottom-color:var(--primary)}
.site-footer .heart{color:#ef4444;filter:saturate(1.1)}
html[data-theme="dark"] .site-footer .heart{color:#f87171}
/* screen-reader only helper (alias to visually-hidden) */
.sr-only{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* Guided Tour */
.tour-overlay{position:fixed;inset:0;z-index:120;pointer-events:none}
.tour-overlay[hidden]{display:none}
.tour-highlight{position:fixed;z-index:110;border:2px solid var(--primary);border-radius:10px;box-shadow:0 0 0 9999px rgba(0,0,0,.45);transition:all .2s ease}
.tour-highlight[hidden]{display:none}
.tour-tooltip{position:fixed;max-width:340px;z-index:130}
.tour-tooltip .controls .btn{pointer-events:auto}
.tour-tooltip h4{font-size:1rem}
.tour-tooltip:focus{outline:none}
.tour-tooltip .btn:focus{outline:2px solid var(--primary)}
.tour-tooltip .btn{outline-offset:2px}

/* Audit Charts */
.audit-charts{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin:10px 0}
.mini-card{background:var(--card-bg);border:1px solid var(--border);border-radius:10px;padding:10px;box-shadow:var(--shadow)}
.bars{display:flex;flex-direction:column;gap:6px}
.bar-row{display:flex;align-items:center;gap:8px}
.bar-label{flex:0 0 90px;color:var(--muted);font-size:.85rem}
.bar{height:10px;background:linear-gradient(90deg,var(--primary),#60a5fa);border-radius:999px}
.bar-val{margin-left:auto;color:var(--muted);font-size:.85rem}
.columns{display:flex;align-items:flex-end;gap:6px;height:80px}
.col{flex:1;background:linear-gradient(180deg,#60a5fa,var(--primary));border-radius:6px 6px 0 0;min-width:8px}
.col-labels{display:flex;justify-content:space-between;color:var(--muted);font-size:.7rem;margin-top:4px}
